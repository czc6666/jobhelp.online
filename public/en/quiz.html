<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Start Test | Career Compass</title>
    <meta name="description" content="Answer 5 carefully designed questions to instantly get an AI-generated deep career personality analysis report and begin your career exploration journey.">
    <meta name="keywords" content="career test, personality analysis, AI career advisor, career direction, Career Compass, online quiz">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://jobhelp.online/en/quiz.html">

    <!-- Hreflang for SEO -->
    <link rel="alternate" hreflang="zh" href="https://jobhelp.online/quiz.html">
    <link rel="alternate" hreflang="en" href="https://jobhelp.online/en/quiz.html">
    <link rel="alternate" hreflang="es" href="https://jobhelp.online/es/quiz.html">
    <link rel="alternate" hreflang="de" href="https://jobhelp.online/de/quiz.html">
    <link rel="alternate" hreflang="x-default" href="https://jobhelp.online/quiz.html">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jobhelp.online/en/quiz.html">
    <meta property="og:title" content="Start Test | Career Compass">
    <meta property="og:description" content="Answer 5 carefully designed questions to instantly get an AI-generated deep career personality analysis report.">
    <meta property="og:image" content="https://jobhelp.online/og-image.png">
    <meta property="og:site_name" content="Career Compass">
    <meta property="og:locale" content="en_US">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://jobhelp.online/en/quiz.html">
    <meta name="twitter:title" content="Start Test | Career Compass">
    <meta name="twitter:description" content="Answer 5 carefully designed questions to instantly get an AI-generated deep career personality analysis report.">
    <meta name="twitter:image" content="https://jobhelp.online/og-image.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <!-- Turnstile Script -->
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js?onload=onTurnstileLoad" async defer></script>
    <style>
        /* Base styling for smooth transitions */
        .quiz-card, #direct-input-container {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            transform: translateX(0) scale(1);
            opacity: 1;
            will-change: transform, opacity;
            min-height: 32rem; /* Fix for jittering button */
        }

        /* Animation states */
        .card-enter {
            transform: translateX(100%) scale(0.9);
            opacity: 0;
        }
        .card-exit {
            transform: translateX(-100%) scale(0.9);
            opacity: 0;
        }

        /* For the loading spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border-left-color: #09f;
            animation: spin 1s ease infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
    <!-- Structured Data (JSON-LD) for SEO -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [{
            "@type": "Question",
            "name": "Is this test and analysis free?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, it's completely free. We are committed to helping more people who are confused about their future through AI technology. Some of the models we use are provided with free quotas by platforms like OpenRouter, allowing us to pass this value on to you."
            }
        }, {
            "@type": "Question",
            "name": "Is my data and personal information secure?",
            "acceptedAnswer": {
                "@type": "Answer",
                "text": "We take your privacy very seriously. Your answers and conversations with the AI are anonymous and are only used for the current analysis and dialogue. We do not store or use them for any other purpose."
            }
        }]
    }
    </script>
</head>
<body class="bg-gray-50 flex flex-col min-h-screen">

    <!-- Header -->
    <header class="w-full bg-white/80 backdrop-blur-md sticky top-0 z-10 border-b border-gray-200">
        <div class="container mx-auto px-6 py-4 flex items-center justify-between">
            <a href="/en/" class="text-xl font-bold text-gray-900">Career Compass</a>
            <a href="/en/" class="text-sm font-semibold text-gray-600 hover:text-blue-600">
                &larr; Back to Home
            </a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow flex flex-col items-center justify-center p-4">
        <div id="view-container" class="w-full max-w-2xl mx-auto">
            <!-- Quiz Container -->
            <div id="quiz-container">
                <!-- This div will hold the actively transitioning cards -->
            </div>

            <!-- Direct Input Container (hidden by default) -->
            <div id="direct-input-container" class="hidden bg-white rounded-xl shadow-lg p-6 md:p-10">
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-2">Talk Directly to the AI Mentor</h2>
                <p class="text-gray-600 mb-6">Enter your concerns, thoughts, or a self-introduction below, and the AI will generate a personalized career planning report for you.</p>
                <textarea id="direct-input-text" rows="8" placeholder="e.g., I'm a junior majoring in marketing, but I feel I'm introverted and don't enjoy socializing. I'm confused about my future and don't know what I can do..." class="w-full border rounded-lg p-3 text-base focus:ring-2 focus:ring-blue-500 focus:outline-none"></textarea>
                <button id="direct-input-submit-btn" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-full text-base inline-block hover:bg-blue-700 transition mt-6">
                    Let AI Analyze for Me
                </button>
            </div>
        </div>

        <!-- Skip Quiz Link -->
        <div id="skip-quiz-container" class="text-center mt-6">
            <button id="skip-quiz-btn" class="text-sm font-semibold text-gray-500 hover:text-blue-600 transition">
                Don't want to answer questions? Input your thoughts directly &rarr;
            </button>
        </div>

        <!-- Results/Chat Container -->
        <div id="results-container" class="w-full max-w-3xl mx-auto hidden">
            <div id="initial-result" class="text-center bg-white rounded-xl shadow-lg p-6 md:p-10">
                <!-- Initial summary will be injected here -->
            </div>

            <div id="chat-wrapper" class="hidden mt-6 bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-4">In-depth Conversation with AI Mentor</h2>
                <div id="chat-history" class="h-[50vh] overflow-y-auto pr-4 mb-4 border-b">
                    <!-- Full report and chat history will appear here -->
                </div>
                <div id="chat-input-container" class="flex items-center pt-4">
                    <input type="text" id="chat-input" placeholder="Have other questions? Enter here..." class="flex-grow border rounded-l-lg p-3 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    <button id="send-btn" class="bg-blue-600 text-white font-semibold px-6 py-3 rounded-r-lg hover:bg-blue-700 transition">&rarr;</button>
                </div>
            </div>
        </div>

        <!-- Additional Content Section -->
        <section id="additional-content" class="w-full mt-16 mb-16">
            <div class="container mx-auto px-6">
                
                <!-- Usage Examples -->
                <div class="mb-16">
                    <h2 class="text-3xl font-bold text-center text-gray-900 mb-10">See How They Found Their Direction</h2>
                    <div class="max-w-5xl mx-auto">
                        <div class="grid md:grid-cols-2 gap-8">
                            <div class="bg-white p-6 rounded-xl shadow-lg">
                                <blockquote class="text-gray-600">
                                    <p>"I always thought my introverted personality didn't fit my marketing major. After talking with the AI mentor, it helped me identify the 'Data Analyst (Marketing)' role, which uses my professional knowledge without requiring too much social interaction. It's perfect for me!"</p>
                                </blockquote>
                                <p class="mt-4 font-semibold text-gray-900">- Li, a junior student</p>
                            </div>
                            <div class="bg-white p-6 rounded-xl shadow-lg">
                                <blockquote class="text-gray-600">
                                    <p>"After working for three years, I felt like I was just repeating myself every day and lost my passion. Through 'Career Compass', I discovered my core drivers are 'creativity' and 'autonomy'. I'm now learning to develop my own small product in my spare time, and life feels hopeful again."</p>
                                </blockquote>
                                <p class="mt-4 font-semibold text-gray-900">- Ms. Wang, a young professional</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FAQ -->
                <div class="max-w-3xl mx-auto mb-16">
                    <h2 class="text-3xl font-bold text-center text-gray-900 mb-10">Frequently Asked Questions</h2>
                    <div class="space-y-4">
                        <details class="group bg-white p-4 rounded-xl shadow-lg cursor-pointer">
                            <summary class="flex justify-between items-center font-semibold text-gray-900">
                                Is this test and analysis free?
                                <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </summary>
                            <p class="mt-3 text-gray-600">
                                Yes, it's completely free. We are committed to helping more people who are confused about their future through AI technology. Some of the models we use are provided with free quotas by platforms like OpenRouter, allowing us to pass this value on to you.
                            </p>
                        </details>
                        <details class="group bg-white p-4 rounded-xl shadow-lg cursor-pointer">
                            <summary class="flex justify-between items-center font-semibold text-gray-900">
                                Is my data and personal information secure?
                                <svg class="w-5 h-5 transform transition-transform group-open:rotate-180" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </summary>
                            <p class="mt-3 text-gray-600">
                                We take your privacy very seriously. Your answers and conversations with the AI are anonymous and are only used for the current analysis and dialogue. We do not store or use them for any other purpose.
                            </p>
                        </details>
                    </div>
                </div>

                <!-- Feedback -->
                <div class="text-center">
                     <h2 class="text-3xl font-bold text-center text-gray-900 mb-4">Have Suggestions or Feedback?</h2>
                     <p class="text-gray-600 mb-6">We would love to hear your voice to help us make the product better.</p>
                     <a href="mailto:feedback@jobhelp.online" class="bg-gray-900 text-white font-bold py-3 px-6 rounded-full text-base inline-block hover:bg-gray-700 transition">
                        Contact Us
                    </a>
                </div>

            </div>
        </section>
    </main>

    <!-- Turnstile container, will be managed programmatically -->
    <div id="turnstile-container"></div>

    <!-- Footer -->
    <footer class="w-full py-6 text-center bg-white/50 border-t">
        <p class="text-sm text-gray-500">&copy; 2025 Career Compass. All rights reserved.</p>
    </footer>

    <script>
        const API_URL = "/api/analyze";
        const LANG = "en";
        let turnstileWidgetId = null;
        let actionQueue = [];
        let isVerificationInProgress = false;

        window.onTurnstileLoad = function () {
            if (typeof turnstile !== 'undefined') {
                turnstileWidgetId = turnstile.render('#turnstile-container', {
                    sitekey: '0x4AAAAAABhyfTjwR6RXipd_', 
                    callback: function(token) {
                        isVerificationInProgress = false;
                        const action = actionQueue.shift();
                        if (action) { action(token); }
                    },
                    'expired-callback': function() {
                        isVerificationInProgress = false;
                        if (turnstileWidgetId) { turnstile.reset(turnstileWidgetId); }
                    },
                    'error-callback': function() {
                        isVerificationInProgress = false;
                        console.error('Turnstile verification failed.');
                        alert('Security verification failed. Please refresh the page and try again.');
                    },
                    size: 'invisible'
                });
            }
        };

        function withTurnstileVerification(action) {
            if (isVerificationInProgress) { return; }
            actionQueue.push(action);
            isVerificationInProgress = true;
            if (turnstileWidgetId) { turnstile.execute(turnstileWidgetId); }
        }

        const questions = [
            {
                question: "Imagine you are at a casual party. Which activity would you most likely be drawn to?",
                options: [
                    "Engaging in a deep, one-on-one conversation with a close friend.",
                    "People-watching and analyzing the social dynamics.",
                    "Participating in a lively board game or group activity.",
                    "Helping the host with organizing food or making sure everyone is having a good time."
                ]
            },
            {
                question: "If you had an entirely free weekend, how would you ideally spend it?",
                options: [
                    "Reading a book, learning a new skill, or watching a documentary.",
                    "Creating something: writing, drawing, making music, or a DIY project.",
                    "Going for a hike, playing a sport, or doing some other outdoor physical activity.",
                    "Spending quality time with family or friends."
                ]
            },
            {
                question: "When faced with a complex problem at work, what is your initial approach?",
                options: [
                    "Gathering and analyzing data to understand the root cause.",
                    "Brainstorming creative and unconventional solutions.",
                    "Organizing a team and delegating tasks to tackle it from multiple angles.",
                    "Considering the impact of the problem on team members and customers."
                ]
            },
            {
                question: "What motivates you the most in a career?",
                options: [
                    "Mastery of a skill and becoming an expert in your field.",
                    "The opportunity to express creativity and innovate.",
                    "Leadership, influence, and achieving ambitious goals.",
                    "Helping others and making a positive impact on society."
                ]
            },
            {
                question: "What kind of work environment do you prefer?",
                options: [
                    "A quiet, structured environment where you can focus on your tasks.",
                    "A dynamic, flexible environment that encourages experimentation.",
                    "A competitive, results-driven environment with clear targets.",
                    "A collaborative, supportive environment focused on teamwork."
                ]
            }
        ];

        let currentQuestionIndex = 0;
        const userAnswers = [];
        const converter = new showdown.Converter({
            simplifiedAutoLink: true,
            strikethrough: true,
            tables: true
        });

        document.addEventListener("DOMContentLoaded", () => {
            renderQuestion(currentQuestionIndex);
            document.getElementById('skip-quiz-btn').addEventListener('click', showDirectInput);
            document.getElementById('direct-input-submit-btn').addEventListener('click', handleDirectInputSubmit);
        });

        function renderQuestion(index) {
            const quizContainer = document.getElementById('quiz-container');
            const questionData = questions[index];
            const card = document.createElement('div');
            card.className = 'quiz-card bg-white rounded-xl shadow-lg p-6 md:p-10 card-enter';
            card.innerHTML = `
                <div class="text-right text-sm text-gray-500 mb-4">Question ${index + 1} / ${questions.length}</div>
                <h2 class="text-2xl md:text-3xl font-bold text-gray-900 mb-6">${questionData.question}</h2>
                <div class="space-y-4">
                    ${questionData.options.map((option, i) => `
                        <button data-answer="${i}" class="w-full text-left bg-gray-100 hover:bg-blue-100 border border-gray-200 text-gray-800 font-semibold py-3 px-5 rounded-lg transition">
                            ${option}
                        </button>
                    `).join('')}
                </div>`;

            quizContainer.innerHTML = ''; // Clear previous card
            quizContainer.appendChild(card);

            // Add event listeners to new buttons
            card.querySelectorAll('button[data-answer]').forEach(button => {
                button.addEventListener('click', handleAnswer);
            });
            
            // Trigger animation
            setTimeout(() => card.classList.remove('card-enter'), 10);
        }

        function handleAnswer(event) {
            userAnswers.push(event.target.innerText);
            const card = document.querySelector('.quiz-card');
            
            card.classList.add('card-exit');
            card.addEventListener('transitionend', () => {
                currentQuestionIndex++;
                if (currentQuestionIndex < questions.length) {
                    renderQuestion(currentQuestionIndex);
                } else {
                    startAnalysis(userAnswers);
                }
            }, { once: true });
        }

        function showDirectInput() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('skip-quiz-container').classList.add('hidden');
            const directInputContainer = document.getElementById('direct-input-container');
            directInputContainer.classList.remove('hidden');
        }

        function handleDirectInputSubmit() {
            const text = document.getElementById('direct-input-text').value.trim();
            if (text.length < 20) {
                alert("For a more in-depth analysis, please describe your situation in more detail (at least 20 characters).");
                return;
            }
            startAnalysis(text);
        }

        function startAnalysis(data) {
            // Hide quiz/input view and show results container
            document.getElementById('view-container').classList.add('hidden');
            document.getElementById('skip-quiz-container').classList.add('hidden');
            const resultsContainer = document.getElementById('results-container');
            resultsContainer.classList.remove('hidden');

            const initialResultDiv = document.getElementById('initial-result');
            initialResultDiv.innerHTML = `
                <div class="spinner mx-auto mb-4"></div>
                <h2 class="text-2xl font-bold text-gray-800">Your AI mentor is thinking...</h2>
                <p class="text-gray-600 mt-2">Analyzing your answers and generating your career personality report. This may take about 15 seconds.</p>`;
            
            withTurnstileVerification((token) => {
                fetchAnalysis(data, token, true);
            });
        }
        
        let fullReport = "";

        function fetchAnalysis(data, token, isInitialAnalysis) {
            const prompt = isInitialAnalysis ? 
                (Array.isArray(data) ? `Here are my answers to the quiz: ${data.join(', ')}` : data) :
                `Previous conversation context: "${fullReport}"\n\nMy new question: "${data}"`;

            let accumulatedContent = "";
            
            fetch(API_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ prompt, lang: LANG, turnstileToken: token })
            })
            .then(response => {
                if (!response.body) throw new Error('ReadableStream not available.');
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                
                const targetDiv = isInitialAnalysis ? document.getElementById('initial-result') : null;
                const chatHistoryDiv = isInitialAnalysis ? null : document.getElementById('chat-history');
                let aiMessageContainer;

                if (chatHistoryDiv) {
                    aiMessageContainer = document.createElement('div');
                    aiMessageContainer.className = 'mb-4';
                    aiMessageContainer.innerHTML = '<div class="font-bold text-gray-800 mb-1">AI Mentor</div><div class="bg-gray-100 p-3 rounded-lg"></div>';
                    chatHistoryDiv.appendChild(aiMessageContainer);
                }

                function push() {
                    reader.read().then(({ done, value }) => {
                        if (done) {
                            if (isInitialAnalysis) {
                                fullReport = accumulatedContent; // Store the full initial report
                                showChatInterface();
                            } else {
                                fullReport += `\n\nUser question: ${data}\nAI answer: ${accumulatedContent}`; // Append follow-up to context
                            }
                            enableChatInput();
                            return;
                        }
                        accumulatedContent += decoder.decode(value, { stream: true });
                        const htmlContent = converter.makeHtml(accumulatedContent);
                        
                        if (targetDiv) {
                            targetDiv.innerHTML = htmlContent;
                        } else if (aiMessageContainer) {
                            aiMessageContainer.querySelector('.bg-gray-100').innerHTML = htmlContent;
                            chatHistoryDiv.scrollTop = chatHistoryDiv.scrollHeight;
                        }

                        push();
                    }).catch(error => {
                        console.error('Streaming error:', error);
                        const errorMsg = "<p class='text-red-500'>Sorry, an error occurred while communicating with the AI. Please try again later.</p>";
                        if (targetDiv) targetDiv.innerHTML = errorMsg;
                        if (aiMessageContainer) aiMessageContainer.innerHTML = errorMsg;
                        enableChatInput();
                    });
                }
                push();
            })
            .catch(err => {
                console.error('Fetch error:', err);
                const errorMsg = "<p class='text-red-500'>Sorry, a network error occurred. Please check your connection and try again.</p>";
                if (isInitialAnalysis) {
                    document.getElementById('initial-result').innerHTML = errorMsg;
                }
                 enableChatInput();
            });
        }

        function showChatInterface() {
            document.getElementById('chat-history').innerHTML = `
                <div class="mb-4">
                    <div class="font-bold text-gray-800 mb-1">Full AI Report</div>
                    <div class="bg-gray-100 p-3 rounded-lg">${converter.makeHtml(fullReport)}</div>
                </div>`;
            document.getElementById('chat-wrapper').classList.remove('hidden');
            document.getElementById('chat-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    document.getElementById('send-btn').click();
                }
            });
            document.getElementById('send-btn').addEventListener('click', handleSendMessage);
            enableChatInput();
        }

        function handleSendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            if (!message) return;

            disableChatInput();
            
            const chatHistory = document.getElementById('chat-history');
            chatHistory.innerHTML += `
                <div class="mb-4 text-right">
                    <div class="font-bold text-blue-600 mb-1">You</div>
                    <div class="bg-blue-100 inline-block p-3 rounded-lg">${message}</div>
                </div>`;
            chatHistory.scrollTop = chatHistory.scrollHeight;

            input.value = '';

            withTurnstileVerification((token) => {
                fetchAnalysis(message, token, false);
            });
        }
        
        function disableChatInput() {
            document.getElementById('chat-input').disabled = true;
            document.getElementById('send-btn').disabled = true;
            document.getElementById('send-btn').innerHTML = '<div class="spinner mx-auto" style="width: 24px; height: 24px; border-width: 3px;"></div>';
        }

        function enableChatInput() {
            document.getElementById('chat-input').disabled = false;
            document.getElementById('send-btn').disabled = false;
            document.getElementById('send-btn').innerHTML = '&rarr;';
        }

    </script>
</body>
</html>
